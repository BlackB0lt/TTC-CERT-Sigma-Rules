title: CVE-2023-23397 Exploitation Detection
id: 14c81ec9-21fb-45b2-9405-e32126842d33
version: 1.0
first_imported: 2023-03-17
last_modified: 2023-03-17
status: RELEASED
sharing: TLP:CLEAR
author: TTC-CERT
status: test
description: This rule identifies the occurrence of "svchost.exe" spawning "rundll32.exe" with command arguments, C:\windows\system32\davclnt.dll,DavSetCookie IP address http://IP address/foobar, while also excluding private IP addresses.
references:
    - https://twitter.com/ACEResponder/status/1636116096506818562/
    - https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_rundll32_webdav_client_execution.yml (Modified from this rule)
logsource:
    category: process_creation
    product: windows
detection:
    selection_img:
        - Image|endswith: '\rundll32.exe'
        - OriginalFileName: 'RUNDLL32.EXE'
    selection_cli:
        CommandLine|contains: 'C:\windows\system32\davclnt.dll,DavSetCookie'
    filter_private_ip:
        CommandLine|contains:
            - ' 10.' #10.0.0.0/8
            - ' 192.168.' #192.168.0.0/16
            - ' 172.16.' #172.16.0.0/12
            - ' 172.17.'
            - ' 172.18.'
            - ' 172.19.'
            - ' 172.20.'
            - ' 172.21.'
            - ' 172.22.'
            - ' 172.23.'
            - ' 172.24.'
            - ' 172.25.'
            - ' 172.26.'
            - ' 172.27.'
            - ' 172.28.'
            - ' 172.29.'
            - ' 172.30.'
            - ' 172.31.'
            - ' 127.' #127.0.0.0/8
            - ' 169.254.' #169.254.0.0/16
    condition: selection_img and selection_cli and not filter_private_ip
falsepositives: Unknown
level: high
